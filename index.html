<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
	<meta charset="utf-8" />
	<title>Fluid</title>
	<meta
			name="viewport"
			content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
	<style>
		:root {
			--highlight-color: hsl(227, 90%, 76%);
			--select-border: #777;
			--select-focus: var(--highlight-color);
			--select-arrow: var(--select-border);
		}

		*,
		*::before,
		*::after {
			box-sizing: border-box;
		}

		* {
			margin: 0;
			padding: 0;
		}

		/* inter-regular - latin */
		@font-face {
			font-display: swap;
			font-family: 'Inter';
			font-style: normal;
			font-weight: 400;
			src: url('/assets/fonts/inter-v12-latin-regular.woff2') format('woff2');
		}

		/* inter-700 - latin */
		@font-face {
			font-display: swap;
			font-family: 'Inter';
			font-style: normal;
			font-weight: 700;
			src: url('/assets/fonts/inter-v12-latin-700.woff2') format('woff2');
		}

		html,
		body {
			min-height: 100dvh;
			font-family: 'Inter', sans-serif;
		}

		body {
			background-image: linear-gradient(114.02deg, #a74fec 4.94%, #5f6cfa 53.23%, #8ca4f9 93.25%);
			background-image: linear-gradient(114.02deg in oklch,
			oklch(61.1% 0.229 306.48) 4.94%,
			oklch(60.01% 0.209 274.26) 53.23%,
			oklch(73.51% 0.126 271.04) 93.25%);
			padding: 1rem;
			color: #262729;
		}

		nav {
			display: flex;
			flex-wrap: wrap;
			gap: 1rem;
		}

		button {
			border: none;
			cursor: pointer;
			transition: color 0.25ms ease;
			background-color: transparent;
		}

		.open-button {
			border: 1px solid hsl(0, 0%, 100%);
			border-radius: 4px;
			padding: 0.5rem 1rem;
			transition: border 0.25s ease;
			color: #fff;
		}

		.open-button:disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}

		.open-button:hover {
			border: 1px solid hsla(0, 0%, 100%, 0.8);
		}

		.trigger-close-settings {
			line-height: 1;
			font-size: 26px;
			color: hsla(0, 0%, 0%, 1);
		}

		.trigger-close-settings:hover {
			color: hsla(0, 0%, 0%, 0.5);
		}

		.trigger-settings {
			color: hsla(0, 0%, 100%, 0.8);
			margin-block-end: 1rem;
		}

		.trigger-settings:hover {
			color: hsla(0, 0%, 100%, 1);
		}

		.trigger-settings svg {
			width: 1.5rem;
			height: 1.5rem;
			width: 1rem;
			height: 1rem;
		}

		.settings {
			transform: translate3d(-1rem, -110%, 0);
			transition: transform 0.3s linear;
			position: fixed;
			z-index: 1;
			inset-block-start: 0;
			border-radius: 0 0 4px 4px;
			padding: 1em;
			inline-size: max-content;
			background-color: #fff;
			--shadow-color: 227deg 90% 76%;
			box-shadow: 0.3px 0.5px 0.7px hsl(var(--shadow-color) / 0.36), 0.8px 1.6px 2px -0.8px hsl(var(--shadow-color) / 0.36),
			2.1px 4.1px 5.2px -1.7px hsl(var(--shadow-color) / 0.36), 5px 10px 12.6px -2.5px hsl(var(--shadow-color) / 0.36);
		}

		.settings.is-active {
			transform: translate3d(-1rem, 0, 0);
		}

		.settings-backdrop {
			display: none;
		}

		.settings-backdrop.is-active {
			display: block;
			inline-size: 100%;
			block-size: 100%;
			position: fixed;
			inset: 0;
			z-index: 0;
		}

		.hint {
			margin-block-end: 0.75rem;
			font-size: 0.75rem;
		}

		.hint a {
			color: inherit;
		}

		label {
			font-size: 0.75rem;
			display: block;
			margin-block: 0.75rem 0.25rem;
		}

		select {
			appearance: none;
			background-color: transparent;
			border: none;
			padding: 0 1em 0 0;
			margin: 0;
			width: 100%;
			font-family: inherit;
			font-size: 0.75rem;
			cursor: inherit;
			line-height: inherit;
			z-index: 1;
			outline: none;
			color: #262729;
		}

		.select {
			display: grid;
			grid-template-areas: 'select';
			align-items: center;
			position: relative;
			min-width: 15ch;
			max-width: 30ch;
			border: 1px solid var(--select-border);
			border-radius: 0.25em;
			padding: 0.25em 0.5em;
			font-size: 1.25rem;
			cursor: pointer;
			line-height: 1.1;
			background-color: #fff;
			background-image: linear-gradient(to top, #f9f9f9, #fff 33%);
		}

		.select:not(.select--multiple)::after {
			content: '';
			justify-self: end;
			width: 0.8em;
			height: 0.5em;
			background-color: var(--select-arrow);
			clip-path: polygon(100% 0%, 0 0%, 50% 100%);
		}

		select,
		.select::after {
			grid-area: select;
		}

		select:focus+.focus {
			position: absolute;
			top: -1px;
			left: -1px;
			right: -1px;
			bottom: -1px;
			border: 2px solid var(--select-focus);
			border-radius: inherit;
		}

		.qr-space {
			display: none;
			justify-content: center;
			align-items: center;
			margin-top: 1rem;
			width: 100%;
			height: 80vh;
		}

		.qr-space--visible {
			display: flex;
		}

		.qr {
			width: 20%;
		}

		@media only screen and (max-width: 480px) {
			.qr {
				width: 80%;
			}
		}

		.highrollerUserArea {
			display: none;
		}
	</style>
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png" />
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png" />
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png" />
</head>

<body>
<button type="button" class="trigger-settings" onclick="displaySettings()">
	<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"
	     aria-label="Open the settings">
		<title>cog</title>
		<path
				d="M29.181 19.070c-1.679-2.908-0.669-6.634 2.255-8.328l-3.145-5.447c-0.898 0.527-1.943 0.829-3.058 0.829-3.361 0-6.085-2.742-6.085-6.125h-6.289c0.008 1.044-0.252 2.103-0.811 3.070-1.679 2.908-5.411 3.897-8.339 2.211l-3.144 5.447c0.905 0.515 1.689 1.268 2.246 2.234 1.676 2.903 0.672 6.623-2.241 8.319l3.145 5.447c0.895-0.522 1.935-0.82 3.044-0.82 3.35 0 6.067 2.725 6.084 6.092h6.289c-0.003-1.034 0.259-2.080 0.811-3.038 1.676-2.903 5.399-3.894 8.325-2.219l3.145-5.447c-0.899-0.515-1.678-1.266-2.232-2.226zM16 22.479c-3.578 0-6.479-2.901-6.479-6.479s2.901-6.479 6.479-6.479c3.578 0 6.479 2.901 6.479 6.479s-2.901 6.479-6.479 6.479z"
				fill="currentcolor"></path>
	</svg>
</button>

<nav>
	<button type="button" class="open-button needs-init" onclick="openWallet('deposit')">Deposit</button>
	<button type="button" class="open-button needs-init" onclick="openWallet('quick-deposit')">Quick
		Deposit</button>
	<button type="button" class="open-button needs-init" onclick="openWallet('withdrawal')">Withdrawal</button>
	<button type="button" class="open-button" onclick="revealQR()">Try it elsewhere</button>
	<a href="./fluid-integration-manual/index.html"><button type="button" class="open-button">Integration Manual</button></a>
</nav>

<div class="settings">
	<button type="button" class="trigger-close-settings" onclick="displaySettings()">×</button>

	<label for="operatorSelect">Operator:</label>
	<div class="select">
		<select id="operatorSelect">
			<option value="10000001">Fluid Payments</option>
			<option value="100425990">Highroller</option>
		</select>
		<span class="focus"></span>
	</div>

	<div id="userSelectionArea">
		<label for="userSelect">Operation status:</label>
		<div class="select">
			<select id="userSelect"></select>
		</div>
	</div>

	<div id="highrollerUserSelectionArea" class="highrollerUserArea">
		<label for="highrollerUserSelect">Highroller Logged In User:</label>
		<div class="select">
			<select id="highrollerUserSelect">
				<option value="774861677665320">Canada - johndoe01@test.com</option>
				<option value="515151677666361">Canada - codybrown012@test.com</option>
				<option value="447211677664926">Canada - andreea@soltechnologies.es</option>
				<option value="651951678275286">New Zealand - TobyWollaston@jourrapide.com</option>
				<option value="531681678285409">Norway - JoelMuren@rhyta.com</option>
				<option value="332121678349476">Japan - chenLi@test.com</option>
			</select>
			<span class="focus"></span>
		</div>
	</div>

	<label for="locale">Locale:</label>
	<div class="select">
		<select id="locale">
			<option value="en">English</option>
			<option value="en-CA">Canadian English</option>
			<option value="en-NZ">New Zealand English</option>
			<option value="nb-NO">Norwegian Bokmål</option>
			<option value="ar">عربي</option>
		</select>
		<span class="focus"></span>
	</div>

	<label for="currency">Currency:</label>
	<div class="select">
		<select id="currency">
			<option value="EUR">Euro</option>
			<option value="NZD">Kiwi dollar</option>
			<option value="CAD">Canadian dollar</option>
			<option value="NOK">Norwegian korona</option>
		</select>
		<span class="focus"></span>
	</div>

	<label for="mode">Mode:</label>
	<div class="select">
		<select id="mode">
			<option value="wave">Wave</option>
			<option value="snap">Snap</option>
		</select>
		<span class="focus"></span>
	</div>

	<label for="selectedBonus">Selected Bonus:</label>
	<div class="select">
		<select id="selectedBonus">
			<option value="">-</option>
			<option value="WelcomeBonus">Welcome Bonus</option>
			<option value="LoginBonus">Login Bonus</option>
		</select>
		<span class="focus"></span>
	</div>
</div>

<div class="settings-backdrop" onclick="displaySettings()"></div>

<!-- NOTE: in real-life scenario this block is added to DOM / injected on user login, with session-id provided -->
<script type="module" src="https://getfluid.vercel.app/index.js"></script>
<fluid-widget
		id="fluid-widget"
		operator-id="10000001"
		user-id="10001"
		session-id=""
		locale="en"
		currency="EUR"
		transaction="deposit"
		open="false"
		balance="100"
		withdrawable-balance="20"
		mode="wave"
		selected-bonus=""
		bonuses='[{"code":"WelcomeBonus","title":"Welcome Bonus","description":"150% up to 200€ + 25 Mega Spins","logoUrl":"https://www.datocms-assets.com/94626/1695110079-bonus-image-1.jpg","maxBonus":"200","maxBonusPercentage":"150","termsAndConditions":"<div><h4>Welcome Offer Terms And Conditions</h4><p>1. Your Welcome Offer is:<br>Welcome Bonus 1st Deposit: 100% up to $500 + 50 free spins<br>Welcome Bonus 2nd Deposit: 50% up to $500 + 50 free spins<br>Welcome Bonus 3rd Deposit: 75% up to $500 + 50 free spins<br>Welcome Bonus 4th Deposit: 50% up to $500 + 50 free spins<br><br>2. You must claim each deposit bonus in sequence to be eligible for the next one. You must claim the first bonus to be eligible for the second, then claim the second bonus to be eligible for the third, and then claim the third bonus to be eligible for the fourth.<br><br>3. The maximum win and withdrawal from each Deposit Bonus is $10,000.<br><br>4. The maximum win and withdrawal from free spins winnings is $100.<br>&nbsp;</p><h4>General Bonuses Terms And Conditions</h4><p>1. These Bonus Terms and Conditions apply to all promotions and campaigns offered by Highroller from time to time and form part of the General Terms and Conditions. Promotions will also have specific terms applicable to them stated within the offer.<br><br>2. Bonus play can begin only when your Real Money is depleted. If you make a Real Money withdrawal before you have completed your Bonus wagering the remaining Bonus will be forfeit.<br><br>3. The maximum wager when a Bonus is pending, or actively being turned over is $5 or currency equivalent. You may lose your Winnings if you do not follow this rule.<br><br>4. If a Player attempt to turnover their Casino bonus or use of bonus spins whilst their Real Money is locked in Pending or unsettled Bets, this will be considered abuse of promotion and breach of our Terms and Conditions.<br><br>5. Highroller reserves the right to void winnings as a result of wagering with an active bonus where a value, or part of a value, has been built up by a Player and subsequently activated with real money once the promotion has been completed or cancelled.<br><br>6. A Bonus is only valid once per Account/household/IP address/device. Unless stated otherwise, you must deposit at least $20 or currency equivalent and play $20 or currency equivalent in order to qualify for a Deposit Bonus.<br><br>7. Bonus money will expire 30 days after being awarded to you, unless stated otherwise in a promotional offer.<br><br>8. A Free Spin is Game specific and cannot be transferred. All free spins have a validity of 24 hours, unless stated otherwise in a promotional offer. The winnings have to be wagered 30x and you have 30 days to meet the wagering requirements.<br><br>9. Free Spins that are offered as reward in a Deposit Bonus will be credited after a player has wagered a minimum of $20 or currency equivalent on slots in the Casino, unless stated otherwise. Free spins that do not require a Deposit to trigger are only available if you have made a Deposit at least once over a selected period of time.<br><br>10. You must not engage in any activity which is intended to take unfair advantage of a Bonus. Highroller reserves the right to withdraw the availability of any Promotion and void any wager funded by the Bonus and remove any winnings from such wager at any time and at Highroller’s sole and absolute discretion.<br><br>11. If we have reasonable grounds to suspect that a Bonus is being claimed by or for the benefit of the same person more than once or by a group of people acting in concert then it may withdraw the availability of any Bonus or all Bonuses to that customer or group of customers and/or void any wager funded by the Bonus and remove any winnings from such wager.<br><br>12. Highroller reserves the right to confiscate any winnings obtained as a result of a faulty bonus set up, human error or other errors out of our control.</p><h4>Wager - get paid - Reward:</h4><ul><li>This is a “Live Casino” Reward</li><li>Only Live casino games can contribute towards the wagering requirements.</li><li>This offer is a cash reload, meaning that you will receive cash after completing the wagering requirements. You are free to withdraw this amount at any time after the wagering conditions have been completed.</li><li>If necessary, you are allowed to add more funds by depositing in order to complete the wagering requirements.</li><li>The wagering requirements must be completed in 30 days (unless otherwise stated) or the cash reload will expire.</li><li>The deposit must be wagered 40 times to release the cash reward.</li><li>For example - If you deposit $20, you must wager 40 x $20 in order to release the $20 cash reward.</li><li>You must activate the bonus by claiming it in the reward section on your first deposit.</li><li>No max bet</li><li>Cash reward will be credited automatically to players cash balance.</li><li>Once the money is in your cash balance, you are free to use it as you wish.</li><li>Wagering starts the minute you play your first spin with the cash balance on any live casino game.</li></ul></div>","paymentMethodFilter":[{"providerType":"CREDITCARD"}]},{"code":"DepositBonus","title":"Deposit Bonus","description":"100% up to 250€ + 10 Mega Spins","logoUrl":"https://www.datocms-assets.com/94626/1695110087-bonus-image-2.jpg","maxBonus":"250","termsAndConditions":"<div><h4>Welcome Offer Terms And Conditions</h4><p>1. Your Welcome Offer is:<br>Welcome Bonus 1st Deposit: 100% up to $500 + 50 free spins<br>Welcome Bonus 2nd Deposit: 50% up to $500 + 50 free spins<br>Welcome Bonus 3rd Deposit: 75% up to $500 + 50 free spins<br>Welcome Bonus 4th Deposit: 50% up to $500 + 50 free spins<br><br>2. You must claim each deposit bonus in sequence to be eligible for the next one. You must claim the first bonus to be eligible for the second, then claim the second bonus to be eligible for the third, and then claim the third bonus to be eligible for the fourth.<br><br>3. The maximum win and withdrawal from each Deposit Bonus is $10,000.<br><br>4. The maximum win and withdrawal from free spins winnings is $100.<br>&nbsp;</p><h4>General Bonuses Terms And Conditions</h4><p>1. These Bonus Terms and Conditions apply to all promotions and campaigns offered by Highroller from time to time and form part of the General Terms and Conditions. Promotions will also have specific terms applicable to them stated within the offer.<br><br>2. Bonus play can begin only when your Real Money is depleted. If you make a Real Money withdrawal before you have completed your Bonus wagering the remaining Bonus will be forfeit.<br><br>3. The maximum wager when a Bonus is pending, or actively being turned over is $5 or currency equivalent. You may lose your Winnings if you do not follow this rule.<br><br>4. If a Player attempt to turnover their Casino bonus or use of bonus spins whilst their Real Money is locked in Pending or unsettled Bets, this will be considered abuse of promotion and breach of our Terms and Conditions.<br><br>5. Highroller reserves the right to void winnings as a result of wagering with an active bonus where a value, or part of a value, has been built up by a Player and subsequently activated with real money once the promotion has been completed or cancelled.<br><br>6. A Bonus is only valid once per Account/household/IP address/device. Unless stated otherwise, you must deposit at least $20 or currency equivalent and play $20 or currency equivalent in order to qualify for a Deposit Bonus.<br><br>7. Bonus money will expire 30 days after being awarded to you, unless stated otherwise in a promotional offer.<br><br>8. A Free Spin is Game specific and cannot be transferred. All free spins have a validity of 24 hours, unless stated otherwise in a promotional offer. The winnings have to be wagered 30x and you have 30 days to meet the wagering requirements.<br><br>9. Free Spins that are offered as reward in a Deposit Bonus will be credited after a player has wagered a minimum of $20 or currency equivalent on slots in the Casino, unless stated otherwise. Free spins that do not require a Deposit to trigger are only available if you have made a Deposit at least once over a selected period of time.<br><br>10. You must not engage in any activity which is intended to take unfair advantage of a Bonus. Highroller reserves the right to withdraw the availability of any Promotion and void any wager funded by the Bonus and remove any winnings from such wager at any time and at Highroller’s sole and absolute discretion.<br><br>11. If we have reasonable grounds to suspect that a Bonus is being claimed by or for the benefit of the same person more than once or by a group of people acting in concert then it may withdraw the availability of any Bonus or all Bonuses to that customer or group of customers and/or void any wager funded by the Bonus and remove any winnings from such wager.<br><br>12. Highroller reserves the right to confiscate any winnings obtained as a result of a faulty bonus set up, human error or other errors out of our control.</p><h4>Wager - get paid - Reward:</h4><ul><li>This is a “Live Casino” Reward</li><li>Only Live casino games can contribute towards the wagering requirements.</li><li>This offer is a cash reload, meaning that you will receive cash after completing the wagering requirements. You are free to withdraw this amount at any time after the wagering conditions have been completed.</li><li>If necessary, you are allowed to add more funds by depositing in order to complete the wagering requirements.</li><li>The wagering requirements must be completed in 30 days (unless otherwise stated) or the cash reload will expire.</li><li>The deposit must be wagered 40 times to release the cash reward.</li><li>For example - If you deposit $20, you must wager 40 x $20 in order to release the $20 cash reward.</li><li>You must activate the bonus by claiming it in the reward section on your first deposit.</li><li>No max bet</li><li>Cash reward will be credited automatically to players cash balance.</li><li>Once the money is in your cash balance, you are free to use it as you wish.</li><li>Wagering starts the minute you play your first spin with the cash balance on any live casino game.</li></ul></div>","paymentMethodFilter":[{"providerType":"CREDITCARD"},{"providerType":"WEBREDIRECT","service":"BLIXTPAY"}]},{"code":"LoginBonus","title":"Login Bonus","description":"100% up to 150€ + 10 Mega Spins","logoUrl":"https://www.datocms-assets.com/94626/1695110079-bonus-image-1.jpg","maxBonus":"150","maxBonusPercentage":"100","termsAndConditions":"<div><h4>Welcome Offer Terms And Conditions</h4><p>1. Your Welcome Offer is:<br>Welcome Bonus 1st Deposit: 100% up to $500 + 50 free spins<br>Welcome Bonus 2nd Deposit: 50% up to $500 + 50 free spins<br>Welcome Bonus 3rd Deposit: 75% up to $500 + 50 free spins<br>Welcome Bonus 4th Deposit: 50% up to $500 + 50 free spins<br><br>2. You must claim each deposit bonus in sequence to be eligible for the next one. You must claim the first bonus to be eligible for the second, then claim the second bonus to be eligible for the third, and then claim the third bonus to be eligible for the fourth.<br><br>3. The maximum win and withdrawal from each Deposit Bonus is $10,000.<br><br>4. The maximum win and withdrawal from free spins winnings is $100.<br>&nbsp;</p><h4>General Bonuses Terms And Conditions</h4><p>1. These Bonus Terms and Conditions apply to all promotions and campaigns offered by Highroller from time to time and form part of the General Terms and Conditions. Promotions will also have specific terms applicable to them stated within the offer.<br><br>2. Bonus play can begin only when your Real Money is depleted. If you make a Real Money withdrawal before you have completed your Bonus wagering the remaining Bonus will be forfeit.<br><br>3. The maximum wager when a Bonus is pending, or actively being turned over is $5 or currency equivalent. You may lose your Winnings if you do not follow this rule.<br><br>4. If a Player attempt to turnover their Casino bonus or use of bonus spins whilst their Real Money is locked in Pending or unsettled Bets, this will be considered abuse of promotion and breach of our Terms and Conditions.<br><br>5. Highroller reserves the right to void winnings as a result of wagering with an active bonus where a value, or part of a value, has been built up by a Player and subsequently activated with real money once the promotion has been completed or cancelled.<br><br>6. A Bonus is only valid once per Account/household/IP address/device. Unless stated otherwise, you must deposit at least $20 or currency equivalent and play $20 or currency equivalent in order to qualify for a Deposit Bonus.<br><br>7. Bonus money will expire 30 days after being awarded to you, unless stated otherwise in a promotional offer.<br><br>8. A Free Spin is Game specific and cannot be transferred. All free spins have a validity of 24 hours, unless stated otherwise in a promotional offer. The winnings have to be wagered 30x and you have 30 days to meet the wagering requirements.<br><br>9. Free Spins that are offered as reward in a Deposit Bonus will be credited after a player has wagered a minimum of $20 or currency equivalent on slots in the Casino, unless stated otherwise. Free spins that do not require a Deposit to trigger are only available if you have made a Deposit at least once over a selected period of time.<br><br>10. You must not engage in any activity which is intended to take unfair advantage of a Bonus. Highroller reserves the right to withdraw the availability of any Promotion and void any wager funded by the Bonus and remove any winnings from such wager at any time and at Highroller’s sole and absolute discretion.<br><br>11. If we have reasonable grounds to suspect that a Bonus is being claimed by or for the benefit of the same person more than once or by a group of people acting in concert then it may withdraw the availability of any Bonus or all Bonuses to that customer or group of customers and/or void any wager funded by the Bonus and remove any winnings from such wager.<br><br>12. Highroller reserves the right to confiscate any winnings obtained as a result of a faulty bonus set up, human error or other errors out of our control.</p><h4>Wager - get paid - Reward:</h4><ul><li>This is a “Live Casino” Reward</li><li>Only Live casino games can contribute towards the wagering requirements.</li><li>This offer is a cash reload, meaning that you will receive cash after completing the wagering requirements. You are free to withdraw this amount at any time after the wagering conditions have been completed.</li><li>If necessary, you are allowed to add more funds by depositing in order to complete the wagering requirements.</li><li>The wagering requirements must be completed in 30 days (unless otherwise stated) or the cash reload will expire.</li><li>The deposit must be wagered 40 times to release the cash reward.</li><li>For example - If you deposit $20, you must wager 40 x $20 in order to release the $20 cash reward.</li><li>You must activate the bonus by claiming it in the reward section on your first deposit.</li><li>No max bet</li><li>Cash reward will be credited automatically to players cash balance.</li><li>Once the money is in your cash balance, you are free to use it as you wish.</li><li>Wagering starts the minute you play your first spin with the cash balance on any live casino game.</li></ul></div>"}]'>
</fluid-widget>

<script>
	setOpenButtonsEnabled(false);

	listen();

	getSessionId();
	setInterval(getSessionId, 60 * 1000);

	function listen() {
		const fluid = document.querySelector('fluid-widget');

		if (!fluid) {
			return setTimeout(listen, 100);
		}

		// instead of "onevent", this is less convenient although recommended way of handling events
		// https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#inline_event_handlers_%E2%80%94_dont_use_these
		fluid.addEventListener('fluid-command', onFluidCommand);
		fluid.addEventListener('fluid-info', onFluidInfo);
		fluid.addEventListener('fluid-error', onFluidError);

		const localeSelect = document.querySelector('#locale');
		localeSelect.addEventListener('change', (event) => {
			setOpenButtonsEnabled(false);
			fluid.setAttribute('locale', event.target.value);
		});

		const currencySelect = document.querySelector('#currency');
		currencySelect.addEventListener('change', (event) => {
			setOpenButtonsEnabled(false);
			fluid.setAttribute('currency', event.target.value);
		});

		const modeSelect = document.querySelector('#mode');
		modeSelect.addEventListener('change', (event) => {
			fluid.setAttribute('mode', event.target.value);
		});

		const userSelect = document.querySelector('#userSelect');
		userSelect.addEventListener('change', (event) => {
			fluid.setAttribute('user-id', event.target.value);
		});

		const highrollerUserSelect = document.querySelector('#highrollerUserSelect');
		highrollerUserSelect.addEventListener('change', (event) => {
			fluid.setAttribute('user-id', event.target.value);
		});

		const bonusSelect = document.querySelector('#selectedBonus');
		bonusSelect.addEventListener('change', (event) => {
			fluid.setAttribute('selected-bonus', event.target.value);
		});

		const operatorSelect = document.querySelector('#operatorSelect');
		operatorSelect.addEventListener('change', (event) => {
			setOpenButtonsEnabled(false);
			const userSelectionArea = document.querySelector('#userSelectionArea');
			const highrollerUserSelectionArea = document.querySelector('#highrollerUserSelectionArea');
			fluid.setAttribute('operator-id', event.target.value);
			if (event.target.value === '10000001') {
				fluid.setAttribute('user-id', '10001');
				userSelectionArea.style.display = 'block';
				highrollerUserSelectionArea.style.display = 'none';
			} else {
				fluid.setAttribute('user-id', '774861677665320');
				userSelectionArea.style.display = 'none';
				highrollerUserSelectionArea.style.display = 'block';
			}
		});
	}

	function openWallet(operation) {
		const fluid = document.querySelector('fluid-widget');

		fluid.setAttribute('transaction', operation);
		fluid.setAttribute('open', 'true');
	}

	function onFluidCommand(command) {
		console.info(`%cFLUID command: ${command.detail}`, 'color: green');
		switch (command.detail) {
			case 'close':
				const fluid = document.querySelector('fluid-widget');
				fluid.setAttribute('open', 'false');
				break;
			default:
				console.warn('unknown command received');
		}
	}

	function onFluidInfo(info) {
		console.info(`%cFLUID info: ${info.detail}`, 'color: blue');
		switch (info.detail) {
			case 'initialised':
				setOpenButtonsEnabled(true);
				break;
		}
	}

	function onFluidError(error) {
		switch (error.detail) {
			case 'initialisation-failure':
				console.info(`%cFLUID error: ${error.detail}`, 'color: red');
				break;
			default:
				console.info(`%cFLUID error: ${error.detail}`, 'color: orange');
				break;
		}
	}

	async function getSessionId() {
		const getSessionIdUrl = 'https://stage-highroller.uatsecure.com/ajax/token/getToken?token=cashier';
		const response = await fetch(getSessionIdUrl, {
			method: 'GET',
			credentials: 'include',
		});
		const result = await response.json();
		const fluidWidget = document.getElementById('fluid-widget');
		console.log('fetched sessionId:', result.token);
		fluidWidget.setAttribute('session-id', result.token);
	}

	let users = [];
	const urlParams = new URLSearchParams(window.location.search);
	const userId = urlParams.get('user-id');

	async function getUsers() {
		const usersUrl = 'https://fluid-payments.vercel.app/users';
		// const usersUrl = 'https://local.payments.com:9669/users';
		const response = await fetch(usersUrl);
		users = await response.json();

		const userSelect = document.querySelector('#userSelect');

		users.forEach((user) => {
			const option = document.createElement('option');
			option.value = user.userId;
			option.text = user.info;
			option.selected = user.userId === userId;
			userSelect.appendChild(option);
		});
	}
	getUsers();

	function revealQR() {
		document.querySelector('.qr-space').classList.toggle('qr-space--visible');
	}

	async function getUserData() {
		const userDataUrl = 'https://stage-highroller.uatsecure.com/ajax/profile/getData';
		const response = await fetch(userDataUrl, {
			method: 'GET',
			credentials: 'include',
		});
		const result = await response.json();
		const fluidWidget = document.getElementById('fluid-widget');
		if (result && result.balanceDetails) {
			fluidWidget.setAttribute('balance', result.balanceDetails.cash);
			fluidWidget.setAttribute('withdrawable-balance', result.balanceDetails.withdrawableBalance);
		}
	}
	getUserData();

	function displaySettings() {
		document.querySelector('.settings').classList.toggle('is-active');
		document.querySelector('.settings-backdrop').classList.toggle('is-active');
	}

	function setOpenButtonsEnabled(enabled) {
		const needInit = document.getElementsByClassName('needs-init');
		Array.from(needInit).forEach((element) => {
			element.disabled = !enabled;
		});
	}
</script>

<div class="qr-space">
	<img class="qr" src="fluidqr.png" alt="qr-code" />
</div>
</body>

</html>
